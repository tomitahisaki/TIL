# コンピュータ構成基礎

## 構成の表現(重要)

コンピュータはすべての情報を 2 進数で行う(0,1)

1 バイト: 8 ビット

N ビットで表現できる情報量: 2\*\*n 通り

大きいサイズ: K(10\*\*3), M(10\*\*6), G(10\*\*9), T(10\*\*12)

小さいサイズ: m(10**-3) μ(10**-6), n(10**-9), p(10**-12)

文字コード

- ASCII: 英数字・記号・制御文字のみ
- シフト JIS: ASCII に漢字・仮名を追加したもの
- EUC: UNIX や Linux などで使用される。漢字と仮名も使用可能
- Unicode: 世界の文字の多くを一つに体系にした。`UTF-8`がある

## コンピュータの構成

### ハードウェアの一つ

- CPU
  - 制御装置: 記憶装置からプログラムの命令を取り出して、解読・指示を与える
  - 演算装置: 四則演算や論理演算などを行う
- 記憶装置: データやプログラムの記憶を行う
- 入力装置: コンピュータの外部からプログラムやデータを読み込む
- 出力装置: コンピュータ内部で処理されたデータを外部へ書き出す

### ソフトウェア

プログラムやアプリケーションソフトウェアなど

プログラム記憶方式(プログラム格納方式): 主記憶に記憶されたプログラムを、CPU が順に取り出し、解読・実行する方式

## CPU

コンピュータの頭脳 `プロセッサ`とも呼ばれる

### クロック周波数(1 秒間に信号の高低のサイクルが繰り返される回数: Hz)

クロック信号(クロックパルス)は、各装置の動作のタイミングを合わせるために CPU が発する周期的な信号

内部クロック: CPU 内部のクロック周波数
外部クロック: CPU と各装置を結ぶ経路の周波数

バス: コンピュータでデータをやり取りするための伝送路

## CPU の動作原理

### レジスタ

- 命令レジスタ: 実行する命令を格納
- 命令アドレスレジスタ: 次に実行する命令のアドレスを格納
- 指標レジスタ: 基準となるアドレスを格納(指標アドレス指定方式で使用)
- 基底レジスタ: 基準となるアドレスを格納(基底アドレス指定方式で使用)
- アキュムレータ: 演算対象や演算結果を格納する
- 汎用レジスタ: 演算対象や演算結果を格納する 各種目的に仕様

### 命令後

命令部とアドレス部(オペランド部)で構成される

アドレス部: 〇〇
命令部: △△

`〇〇のデータを△△しろ`のような形

### 命令実行サイクル

- **命令の取り出し:** 命令アドレスレジスタを参照し、命令が格納されている主記憶のアドレスを取得。命令を取り出し(命令フェッチ)、命令レジスタに格納。
- **命令の解読:** 命令レジスタの命令部は、デコーダで解読され、演算装置に指示する
- **実効アドレス計算:** 命令レジスタのアドレス部は、アドレスレジスタに送られ、処理対象のデータが格納されているアドレス(実効アドレス)を計算する
- **オペランドの取り出し:** 処理対象データを取り出し、演算装置に送る
- **命令の実行:** 演算装置で演算を実行
- **演算結果の格納:** 演算結果を格納

### アドレス指定方式

**即値アドレス指定方式**:
命令部のアドレス部にデータ自体を格納している方式

**直接アドレス指定方式**:
命令のアドレス部を実効アドレスとする方式

**間接アドレス指定方式**:
命令のアドレス部の値が示すアドレスに格納されている値を、実効アドレスとする方式

**相対アドレス指定方式**:
命令のアドレス部の値と命令アドレスレジスタの値の和を実効アドレスとする方式

**指標アドレス指定方式(インデックスアドレス指定方式)**:
命令のアドレス部の値と指標レジスタの値の和を、実効アドレスとする方式

**基底アドレス指定方式(ベースアドレス指定方式)**:
命令のアドレス部の値と基底レジスタの値の和を、実効アドレスとする方式

## CPU の高速化技術

- 逐次制御方式: １命令ずつ順番に繰り返し実行する方式
- パイプライン方式: 複数の命令を１ステージずつずらしながら並行処理することで、高速化を図る方式
  - 分岐命令のため、実行される確率の高い**分岐予測**や、分岐先が正しければその結果を利用する**投機実行**などがある
- スーパーパイプライン方式: パイプライン方式をさらに細分化した方式
- スーパースカラ方式: 複数のパイプラインを利用して、同時に複数の命令を実行することで、高速化を図る方式

### CPUの命令体系
- CISC(主にPC): 複雑な命令体系で、1回命令で複雑な処理ができる
- RISC(主にスマフォ等): 単純な命令体系で、命令の実行時間が均等　パイプラインで効率よく処理ができる

#### マルチコアプロセッサ
1つのCPU内に複数のコアを備えたもの 従来のシングルコアと比べると、処理速度の高速化を図れる 

コアが多いほど、同時に別の処理を実行することができる

#### GPU
行列演算を用いて3Dの画像処理を高速に実行する画像処理装置 数千個のコアでデータを並列処理する


## 半導体メモリ(重要)
- RAM: 読み書きできるメモリ 電源切ると記憶していた内容が消えてしまう特性(**揮発性**)がある
- ROM: 本来は、読み出し専用のメモリ 電源切っても、記憶していた内容が消えない特性(**不揮発性**)

### RAM
| RAM種類 | 使用回路 | リフレッシュ | 速度 | 集積度 | 価格 | 用途 |
| ------- | -------- | ------------ | ---- | ------ | ---- | ---- |
| DRAM | コンデンサ | 必要 | 低速 | 高い | 安価 | 主記憶 |
| DRAM | フリップフロップ回路 | 不要 | 高速 | 低い | 高価 | キャッシュメモリ |

### ROM
| ROM種類 | 書き込み | 消去 | 特徴 |
| ------- | -------- | ---- | ---- |
| マスクROM | ✗ | ✗ | 製造時に書き込まれた後は、利用者は書き込めない |
| UV-EPROM | ◯ | ◯ | 紫外線照射で全消去できる |
| EEPROM | ◯ | ◯ | 電圧かけて部分消去する 消去・書き込みは1バイト単位で可能 |
| フラッシュメモリ | ◯ | ◯ | 電圧かけて全消去・部分消去 書き換えはブロック単位で消去後に書き込む | 

### キャッシュメモリ
主記憶装置よりも高速で、CPUと主記憶の間に配置するメモリ

#### 実効アクセス時間
アクセスするデータはキャッシュメモリか主記憶のどちらかに存在する 

#### ヒット率
アクセスするデータがキャッシュメモリに存在する確率

以下の場合の実効アクセス時間
ヒット率: 80% 
キャッシュメモリのアクセス時間: 10ナノ秒
主記憶装置のアクセス時間: 60ナノ秒

10 x 0.8 + 60 x 0.2 = 20ナノ秒

キャッシュメモリを使うことで、60 - 20 = 40ナノ秒の短縮が可能となる

アクセスするデータが主記憶に存在する確率を**NFP**と呼ぶ

#### 1次キャッシュと2次キャッシュ
主記憶のアクセス時間とCPUの処理時間の差が大きい場合にL1キャッシュ、L2キャッシュとも呼ばれる


#### キャッシュメモリへの書き込み方式
**ライトスルー方式**: キャッシュメモリと主記憶装置の両方を書き込む方式 常に内容が主記憶とキャッシュで一致するので、一貫性が保たれる。ただし主記憶へ頻繁にアクセスされるので低速

**ライトバック方式**: キャッシュメモリだけ書き込む 主記憶にはデータがキャッシュメモリから追い出されるときに書き込む方式 主記憶とキャッシュメモリの内容が一致しない。一貫性を保つための制御が複雑 主記憶へのアクセスが少ないので高速

### メモリインターブ
主記憶を複数の区画にわけて、連続するアドレスの内容を並列アクセスすることで、アクセスの高速化を図る方式

PCメモリ増設時、大容量1枚とするよりも、同容量2枚1組で装着する。メモリインターブに対応していれば、アクセスの高速化を図れる

### アクセス速度の速い順
**レ・キ・シ・スゴク・ハヤイ**と覚える

高速・小容量 <-------------------------------------------------------> 低速・大容量

レジスタ・1次キャッシュ・2次キャッシュ・主記憶・補助記憶(SSD)・補助記憶(HDD)の順番

## 補助記憶装置
主記憶に比べて、低速だが、大容量で安価・電源オフでも記憶内容が消えない不揮発性の特徴をもつ

### 磁気ディスク装置(HDD)
磁性体を塗ったディスクにデータが記録される ヘッドを移動しながら、データを読み書きする

**構造(セクタ方式)**: セクタ(記録する最小単位)、トラック(セクタの集まった1周分?)、シリンダ(トラックの集まり 概念のみ)

#### アクセス時間
CPUがデータの読み書き指令をだしてから、データの読み書きが終わるまでの時間

- 待ち時間
  - 位置決め時間: ヘッドが目的のデータが存在するトラックまで移動するのに要する時間
  - 回転待ち時間: 目的のデータが、ヘッドの位置まで回転してくるのを待つ時間
- データ転送時間: 目的データがヘッドを通り過ぎるのに要する時間

#### フラグメンテーション
磁気ディスク装置にデータの追加・削除を繰り返すと、データが連続した領域に保存されなくなる現象

**デフラグ** は断片化したデータを連続した領域に再配置し、フラグメンテーションを解消できる

### フラッシュメモリ
電気的に全部または一部分を消去して内容を書き直せる半導体メモリ

USBメモリやSDカードなどがある

### SSD
フラッシュメモリを用いた、磁気ディスク装置の代わりとなる記憶媒体

### 光ディスク
レーザ光を使ってデータを読み書きする記憶媒体

CD, DVD, BDなどがある

**記憶方式の種類**
- 再生専用: ROM  利用者は書き込み不可
- 追記型: R 書き込み可能 書き換え不可
- 書き換え型: RW 書き込み可能 書き換え可能

## 入出力装置
### 入力装置
コンピュータにプログラムやデータ等を入力したり、指示を与えたりする装置

いわゆる、マウスやキーボード

位置情報を入力する装置は、ポインティングデバイスと呼ぶ

#### バーコードリーダ
バーコードを読み取る装置 POSシステムの入力装置として用いられる

- JANコード: 日本で流通している商品を管理するコード チェックディジットで構成されている
- QRコード: 多くの情報を格納でき、エラー訂正機能をもつ2次元コード　キャッシュレス決済でも用いられる

**RFID**: ICチップにアンテナを組み合わせた電子荷札。ICタグとも呼ばれる 定期券や自動貸出などで用いられる

**NFC**はRFIDの国際規格

### 出力装置
コンピュータ内部で処理したデータを外部に出力する装置

### ディスプレイ
- 液晶: 光の透過を画素ごとに制御 カラーフィルタを用いて、色を表現
- 有機EL: 電極の間に電気を通すと発光する特殊な有機化合物を挟んだ構造 低電圧駆動・低消費電力

#### 解像度
文字や画像はドットで表現される ドットのことを画素やピクセルと呼ぶ

解像度は、横x縦のドット数で表す

#### VRAM
ディスプレイに表示される内容を一時的に記録するために使用される専用メモリ

| 1ドットあたりに必要なビット数 | 色数 |
| ----------------------------- | ---- |
| 1ビット                       | 2色(2**1) |
| 8ビット                       | 256色(2**8) |
| 16ビット                      | 65,536色(2**16) |
| 24ビット フルカラー 最も自然な色を表現できる | 16,777,216色(2**24) | 

### プリンタ
- レーザプリンタ
- インクジェットプリンタ
- ドットインパクトプリンタ
- 3Dプリンタ

## 入出力インタフェース
PC本体と周辺機器を接続するための規格総称

### USB
標準的なシリアルインタフェース

いまでは、多くのコネクタが存在する また、企画も1.1→2.0→3.0のように登場している

ホットプラグは、接続されている機器の電源を入れたまま抜き差し可能

バスパワーは、USBケーブルを介して、パソコンの本体から電源を供給する方式

### HDMI
映像、音声、制御信号などを1本のケーブルで入出力できるインタフェース

### Bluetooth
免許不要の2.4GHz帯の電波を利用したインタフェース

半径100m程度の範囲で最大通信速度は24Mbps

### Zigbee
Bluetoothと同じ電波帯

電波の届く範囲は狭く、通信速度も最大250kbps 

LANより狭いPANというネットワークで用いられる

