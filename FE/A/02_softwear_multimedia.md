# ソフトウェアとマルチメディア

##  ソフトウェア
### OS
ハードウェアやアプリケーションソフトウェアを制御・管理するソフトウェア

#### 制御プログラム
ハードウェア資源の状態を常に監視し、コンピュータの効率的な利用を実現するソフトウェア群

- ジョブ管理: ジョブのスケジュール管理を行う。ジョブの豆乳から結果が出るまでの過程を提供する
- タスク管理: CPUを効率よく使用するための割当を行う。 複数のタスクを実行できるマルチタスクの機能を提供する
- 記憶管理: 主記憶を効率よく管理する。実記憶管理と仮想記憶管理を提供する
- ファイル管理: ディレクトリやファイルを管理するファイルシステムの機能を提供する
- その他: 入出力管理　通信管理　セキュリティ管理など

##### 各種ソフトウェア
下記のようにユーザーが触れる部分の土台を構築している

- アプリケーションソフトウェア: アプリケーションソフトウェア(ブラウザやワープロのようなソフト)
- ミドルウェア: 統一的なインタフェースや共通の基本機能を提供するソフトウェア
- OS: 基本ウェア
- ハードウェア: 

#### API
アプリケーション プログラム インタフェースの略

アプリケーションから、OSが用意する各機能を利用するための仕組み

**デバイスドライバ**: PCに接続した周辺機器を制御するソフトウェア

最近は、プラグアンドプレイ(挿すだけで、必要な設定をしてくれる)も多くなっている

### OSS
ソースコードを公開しているソフトウェア 無保証を原則とするが、誰でも自由にソースコードを改変し再頒布できる

**例**
- OS: Linux
- ブラウザ: Firefox
- 電子メール: Thunderbird

他にも多数ある

#### ライセンスについて
代表的なものとして、BSDとGPLというものがある

**BSD**: [無保証],[改変後の再頒布の際に元のソフトウェアの著作権表示部分やライセンス条文はのこす]という2つの制約がある

**GPL**: 上記の制約に加えて、コピーレフトという制約がある。著作権を保持したまま、プログラムの複製、改変、頒布を制限しない

そのプログラムから派生した二次著作物には、オリジナルと同じ配布条件を適応するという考え。

## ジョブ管理とタスク管理
ジョブ: 利用者からみた仕事の単位

タスク(プロセス): OSからみた仕事の単位

### ジョブ管理
ジョブの入力と出力を管理する

入力待ち行列に登録され、順番に処理されるのを待ち、処理された後は、出力待ち行列に登録される

#### スプーリング
主記憶装置と低速の入出力装置との間のデータ転送を補助記憶装置を介して行うこと

スループットの向上に役立つ

### タスク管理
タスクの生成から消滅までを3つの状態で管理する

- 実行可能状態: CPUの使用権が割り当てられるのを待つ状態。実行可能状態のタスクが複数あると、待ち行列を形成する
- 実行状態: CPUの使用権が割り当てられ、実行している状態。
- 待ち状態: 他のタスクが入出力装置を使用しているため、入出力処理が完了するのを待っている状態

#### 状態遷移
1. タスクが実行可能状態になる
2. 実行可能状態のタスクから実行するタスクを選択、そのタスクにCPUの使用権を割り当てると実行状態へ遷移する C**PUの割当をディスパッチ**と呼ぶ
3. 実行状態中に、優先順位の高いタスクが実行可能状態になると、割り込みが発生する。優先順位高いタスクにCPUの使用権が割り当てられ、現在の実行状態のタスクは、実行可能状態へ遷移する
4. 実行状態中に入出力待ちが生じた場合は、処理が完了するまで待ち状態へ遷移する
5. 入出力処理が完了すれば、実行可能状態に背にする

#### タスクのスケジューリング
- 到着順方式: 実行可能待ちの行列の先頭にあるタスクから順に、CPUの使用権を割り当てる
- 処理時間順方式: 処理予定時間が短いタスクから順に、CPUの使用権を割り当てる
- 優先度順方式: 優先度の高いタスク順に、CPUの使用権を割り当てる
- ラウンドロビン方式: 実行可能待ち状態のタスクから順に、CPUの使用権を割り当てる。一定時間が経過した場合は、中断して、実行可能待ち行列の最後尾に加える

#### マルチタスク
複数のタスクにCPUの処理時間を順番に割り当てることで、タスクが同時に実行されているように見せる方式。

**マルチプログラミング**ともよぶ

CPU I/O CPU I/Oのようにタスクの実行と入出力装置の占有時間がある。

I/O処理の時間はCPUは使用されないので、アイドルタイム(遊休時間)が存在する。

その時間に他のタスクを実行させる

**タスクの実行方式**
- ノンプリエンプティブ方式: OSがCPUを管理せず、プログラムに任せる
- プリエンプティブ方式: OSがCPUを管理する。こちらが主流で、タスクの処理順を変えられる(CPUの使用権を割り当てる)

**マルチスレッド**
1つのプログラムの中で、並列処理が可能な部分を、複数の処理単位(スレッド)に分解して、それらを並列して処理するOSの機能

#### 割り込み処理
実行中のプログラムを一時中断し、制御プログラムに制御を移して、必要とする別の処理に切り替えること

- 内部割込み: 実行中のプログラム原因 
  - プログラム割り込み: ゼロ除算、桁あふれなど、不正な命令が原因で発生
  - SVC割り込み: プログラムがOSに入出力を要求したときに発生
- 外部割り込み: 実行中のプログラム以外の原因
  - 機械チェック割り込み: 電源異常、主記憶の故障などのハードウェアの故障が原因で発生
  - 入出力割り込み: 入出力の入出力動作が完了したときに発生
  - タイマ割り込み: プログラムが実行時間が設定時間を超過した際に発生
  - コンソール割り込み: オペレータが介入したときに発生

**M/M/1の待ち行列モデル** 平均待ち時間を求めるのにつかう。コンビニを例えに、客の到着はランダム、レジの処理時間も客ごとにランダム、窓口は1つ。先着順に処理し、列への割り込みや途中抜けはなしとする

## 記憶管理
プログラム記憶方式は、プログラムを主記憶に読み込んでおき、CPUが順次読みだし実行する方式

### 実記憶方式
#### 区画方式
- 固定区画方式: 主記憶を予め決まった大きさの区画に分割する。各プログラムは格納できる大きさの区画に配置される。主記憶の使用効率は悪いが、処理時間は一定で速い。
- 可変区画方式: 主記憶をプラグラムが必要とする大きさの区画に割り当てる。主記憶の使用効率は良いが、処理時間は不定で遅い

**フラグメンテーション**: OSが主記憶の領域獲得と開放を繰り返すと、細切れの未使用領域が発生する現象

**メモリコンパクション**: フラグメンテーションを解決するために、細切れの未使用領域を連続した1つの領域にまとめ、再び利用可能にする

#### スワッピング方式
実行中のプログラムのうち優先度の低いプログラムを一時中断して磁気ディスクに退避(スワップアウト)して、優先度の高いプログラムを主記憶に配置(スワップイン)する方式

#### オーバレイ方式
予めプログラムを同時に実行しない排他的ないくつかの単位(セグメント)に分割し、実行時に必要な部分だけを主記憶に配置して実行する

**メモリリーク**: 使用可能な主記憶の容量が減少すること プログラムやOSバグにより、実行中
に確保した主記憶領域が開放されないことで発生

**ガーべジコレクション**: 不要になった領域を開放する

#### 仮想記憶方式
プログラムを仮想記憶空間に格納しておき、実行時に必要なプログラムやデータを動的に実記憶に配置して実行する方式

補助記憶の一部を主記憶に見せかけて、大きな記憶空間を作っている

仮想記憶上の番地(仮想アドレス)を主記憶上の番地(実アドレス)に変換する必要がある。動的アドレス変換機構(DAT)と呼ばれるハードウェアで行う。

#### ページング方式
主記憶とプログラムを固定長に分割し、ページ単位で管理する方式

**ページフォルト**: ページが主記憶に存在しないときは、割り込みが発生。不要なページを実記憶から補助記憶に追い出し(ページアウト)、必要なページを補助記憶から実記憶に配置(ページイン)

**スラッシング**: ページフォルトが多発すると、処理効率が急激に低下する現象

#### ページ置き換えアルゴリズム
ページング方式で、不要なページを決定する方式
- FIFO方式: 最も古くから主記憶に存在するページを置き換える
- LRU方式: 最後に参照されてから最も経過時間が長いページを置き換える
- LFU方式: 参照回数が最も少ないページを置き換える


