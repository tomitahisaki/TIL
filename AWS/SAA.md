# SAA 試験対策

# メインサービス

## SNI

Server Name indication

暗号化通信で使用するサーバー証明書をパブリック IP アドレスではなくドメイン名で判断する技術

SNI に対応した ELB に複数のサーバー証明書を導入すると、ELB が適切なサーバー証明書を判断して通信を転送する

## Auto Scaling

ヘルスチェックのタイプは、EC2/ELB の 2 種類ある

ヘルスチェックの猶予時間：AutoScaling グループ内のリソースが起動してから、初回のヘルスチェックまでの待機期間

ライフサイクルフック：リソースの増減時に任意の処理を実行する機能
ターゲット追跡スケーリング：1 つのメトリクスが指定した目標値になるようにインスタンスを増減する

## S3

マルチパートアップロード：5GB を超える場合のファイルをアップロードするときに利用

## ELB

固定 IP アドレスを関連付けできるのは、NLB のみ

## WebSocket

一つのコネクションから永続的にサーバー/クライアント双方からデータ送信できる技術

通常は、Web アプリの場合、クライアントからのリクエストにサーバーがレスポンスを返して終了

WebSocket は、一度接続したコネクションではクライアントからのリクエストがなくてもサーバー側からデータを送信可能。WebSocket はチャットや株価情報のような、リアルタイムな情報提供を必要とするアプリケーションで使用

## ネットワーク ACL

VPC 上でネットワークアクセスをサブネットごとに制御するファイアウォール

ネットワーク ACL はステートレスなファイアウォール

IP アドレスをもとに、許可・拒否ルールの両方を設定できる

## セキュリティグループ

VPC 上でネットワークアクセスをインスタンスごとに制御するファイアウォール

通信の状態を管理するステートフルなファイアウォール

## AWS WAF

Web アプリケーションに対する攻撃から保護するサービス

## AWS Shield

AWS で実行している Web アプリケーションへの DDoS 攻撃に対する保護サービス

## ENI（Elastic Network Interface）

AWS リソースのネットワークインターフェイスです。オンプレミス環境における NIC（Network Interface Card）と同じ役割を持ち、VPC 内の EC2 インスタンスや NAT ゲートウェイなどに割り当てて利用します

## VPC フローログ

VPC 内の ENI（Elastic Network Interface）に流れるネットワークトラフィック情報を出力する機能

## VPC エンドポイント

VPC 内の AWS リソースから、S3 や DynamoDB などインターネットから直接利用できる VPC 外の AWS サービスへアクセスは、通常インターネットゲートウェイを経由して通信します。「VPC エンドポイント」は、セキュリティ上の制約でインターネットとの通信が制限されているプライベートサブネット内の AWS リソースから、インターネットゲートウェイを経由せずに VPC 外の AWS サービスへアクセス可能にする機能です

## インターネットゲートウェイ

インターネットゲートウェイは VPC 内の AWS リソースとインターネットを接続する機能です

Egress-Only インターネットゲートウェイは、NAT ゲートウェイとインターネットゲートウェイの特徴を併せ持つ IPv6 専用の機能

## NAT ゲートウェイ

NAT ゲートウェイは、プライベートサブネットからインターネットへの通信を可能にする機能

## NAT インスタンス

NAT ゲートウェイと同じくプライベートサブネットからインターネットへの通信を可能にする IPv4 専用の機能

NAT ゲートウェイはマネージドサービスなのに対し、NAT インスタンスは EC2 インスタンスから作成するため、ユーザーが障害対応などの運用管理を実施する必要がある

NAT ゲートウェイでは利用できないポート転送機能を設定できる

## VPC ピアリング

VPC ピアリングは、VPC 同士を 1 対 1 で接続する機能

## VPC のルートテーブル

VPC 内での通信において、どのネットワークへデータを転送するかを定義する機能

- データの転送先を定義できる
- インターネットゲートウェイをターゲットにすることで、VPC からインターネットへ接続できる

## VPC エンドポイント

VPC 内のリソースは VPC エンドポイントから VPC 外の AWS サービスへアクセスできる

VPC エンドポイントからの接続先を制限できる

## AWS PrivateLink

VPC エンドポイントにはゲートウェイ型と AWS PrivateLink（インターフェイス型）があり、Amazon CloudWatch Logs への接続は「AWS PrivateLink」を利用します

## AWS Transit Gateway

複数の VPC や複数のオンプレミスネットワークを相互に接続するハブ機能を持つサービスです

複数の VPC 同士を 1 つのハブで相互に接続できる。ネットワーク経路を簡略化できる

## EC2

Amazon マシンイメージ（AMI）は、EC2 インスタンスを起動するために必要な OS やミドルウェアなどのテンプレート

## インスタンスの分類

- インスタンスタイプ: CPU、メモリ、ストレージ性能、ネットワークキャパシティーの組み合わせ
- インスタンスストア: 揮発性のブロックストレージ
- インスタンスファミリー:

  - M: 汎用
  - T: 汎用（CPU バースト機能）
  - C: コンピューティング最適化
  - R X: メモリ最適化
  - P G F: 高速コンピューティング
  - I D H: ストレージ最適化

- メタデータ: 実行中のインスタンスに関するデータ

## プレイスメントグループ

複数の EC2 インスタンスを論理的にグループ化し、インスタンス間での低遅延な通信や、ハードウェア障害による影響を軽減できる機能

### クラスタープレイスメントグループ

グループ内の EC2 インスタンスを単一 AZ 内の物理的に近い距離を配置する

各 EC2 インスタンス同士の通信は、遅延が発生しにくく高速通信が可能

クラスタープレイスメントグループが所属する AZ に何らかの障害が発生した場合はサービスが利用不能になってしまうため、可用性を犠牲にしてでも EC2 インスタンス間の通信遅延を極力なくしたい場合に利用

### パーティションプレイスメントグループ

グループをパーティションとよばれる論理グループに分割し、それぞれのパーティションに 1 つ以上の EC2 インスタンスが所属します。各パーティションは 1 つのラックが対応しており、ラックには独立した電源とネットワークが配備されています。グループ内の各パーティションはラックを共有しないので、ハードウェア障害による影響を軽減

異なる AZ にインスタンスを配置できる

### スプレッドプレイスメントグループ

スプレッドプレイスメントグループは、グループ内の EC2 インスタンスを異なるハードウェア（ラック）に配置します。パーティションプレイスメントグループではラック内に同一グループの EC2 インスタンスを 1 つ以上配置しますが、スプレッドプレイスメントグループは同一グループの EC2 インスタンスを 1 つしか配置しません。グループ内の各 EC2 インスタンスはハードウェアを共有しないので、ハードウェア障害による影響を軽減

異なる AZ にインスタンスを配置できる

## S3

- Intelligent-Tiering: ミリ秒単位のアクセスが可能で、アクセス頻度の高いデータ
- 標準: ミリ単位のアクセス可能、アクセス頻度の低いデータ
- 1 ゾーン: 1AZ に保存され、ミリ単位病のアクセスが可能な再利用可能で、アクセス頻度の低いデータ
- Glacier Instant Retrieval: アクセスが四半期に一度の存続期間が長いアーカイブデータ
- Glacier Flexible Retrieval: 取得時間が数分ー数時間、アクセスが 1 年に一度の存続期間が長いアーカイブデータ
- Glacier Deep Archive: 取得時間が数時間、アクセスが 1 年未満の存続期間が長いアーカイブデータ

### Transfer Acceleration

ユーザーから S3 バケットへ最適化したネットワークルートを経由して、データを転送する機能

### クロスリージョンレプリケーション

S3 オブジェクトを自動的に異なるリージョンに保存したい場合に利用

### 取り出し方法

- 標準取り出し：デフォルトのオプション
- 大容量取り出し：標準取り出しより時間がかかるが、取り出し料金が低価格になる
- 迅速取り出し：追加オプションを払って、標準取り出しよりも早くデータをとりだせるオプション

### SSE-S3

鍵は、S3 で管理している

S3 で暗号化を行う

### SSE-C

鍵は、ユーザー側で管理

S3 で暗号化を行う

### 署名付き URL

非公開設定されたオブジェクトに対して有効期期限のついた URL を発行することで、AWS アカウントを持っていないユーザーでも一時的にアクセスが可能になる機能

オブジェクトのダウンロード、アップロード用の URL の発行可能

### MFA Delete

S3 のバージョニング機能を使用して管理されているオブジェクトを削除する際に、MFA デバイスの認証が必要となる機能

MFA Delete を利用すると、ルートユーザー（AWS との契約を行ったアカウント）のみが、世代管理されたデータの削除権限を持つようになる

### ACL

他の AWS アカウントに対して、S3 バケットやオブジェクトへの読み取りまたは書き込みを許可できる機能

バケットやオブジェクトへの読み取りや書き取りを許可する

### バケットポリシー

自 AWS アカウントの IAM ユーザーや他の AWS アカウントのユーザーに対して、S3 のデータへのアクセス権限を設定できる機能

### オブジェクトロック機能

リーガルホールドとリテンションモードがある

リテンションモードは以下のようにわかれている

- ガバナンスモード

  - 権限（s3:BypassGovernanceRetention）を持たないユーザーに対して、指定した保持期間中オブジェクトを読み取り専用にします。権限を持つユーザーのみオブジェクトの更新・削除と、ガバナンスモードの解除ができます。

- コンプライアンスモード
  - ルートユーザーを含む全てのユーザーに対して、指定した保持期間中オブジェクトを読み取り専用にします。保持期間中はルートユーザーを含めてコンプライアンスモードを解除できません。

リーガルホールド
権限（s3:PutObjectLegalHold）を持たないユーザーに対して、リーガルホールドが解除されるまでオブジェクトを読み取り専用にします。権限を持つユーザーのみオブジェクトの更新・削除と、リーガルホールドの解除ができます。

## AWS Organizations

OU（Organizational Units）を利用して、組織を階層的な構造で整理、管理できる

- 複数の AWS アカウントに対して権限を設定できる
- 複数の AWS アカウントの請求を一括処理できる

## IAM ポリシー

ポリシーの種類

- ID ベースのポリシー：IAM ユーザー、IAM グループ、IAM ロールにアタッチするポリシー
  - 管理ポリシー
    - AWS 管理ポリシー：AWS によってあらかじめ定義されたポリシー
    - カスタマー管理ポリシー：ユーザーが定義するポリシー、世代管理可能
  - インラインポリシー：ユーザーが対象毎に作成・付与するポリシー
- リソースベースのポリシー：AWS リソースにアタッチするポリシー

# コンピューティング

## VPC リンク

API Gateway から、直接プライベートサブネット内のリソースにアクセスするために設定する機能

## Lambda

トリガーを設定して、実行できる。リクエストが不定期に発生し、1 リクエストが数秒で終わる処理に適している

- S3 オブジェクト作成時
- DynamoDB のテーブルに変更があるとき
- SQS のキューにメッセージが追加されたとき
- SNS からトピックが通知されたとき

Lambda 関数は、イベントに応じて自動的にスケールし、発生したイベントの数だけ同時実行されます。ある特定の時点で、実行中の Lambda 関数の個数を同時実行数と呼ぶ

Lambda 関数が初めて実行される場合や一定期間実行されていない場合は、Lambda 関数の実行環境であるランタイム環境の準備に時間がかかるため、Lambda 関数の処理が開始されるまで時間がかかります。（コールドスタート）
一方、同じ Lambda 関数に対するリクエストが継続的に発生する場合は、ランタイム環境が再利用されるため準備処理が省略され、Lambda 関数の開始までの時間が短くなります。（ウォームスタート）

リクエスト増加時には、既存のリソースでは追いつかないため、新しいリソースが必要になる。その結果、新しいリソースを準備するためにコールドスタートが必要になり、遅延が発生する。

遅延しないために、ランタイム環境を事前に準備する「プロビジョニングされた同時実行」がよい

VPC アクセスを設定することで、下記のいずれかができなくなる

- プライベートサブネットへのアクセスができなくなる
- インターネットへのアクセスができなくなる

## ECR(Elastic Container Registry)

コンテナイメージを登録・管理ができる。ECR に登録したコンテナイメージから、ECS が参照し、コンテナを起動する

## ECS(Elastic Container Service)

コンテナを管理・実行できる

コンテナオーケストレーション

主要要素に、クラスター・タスク・サービスがある

- クラスター：1 つ以上のタスクまたはサービスに構成される論理グループ
- タスク：実行環境の CPU やメモリのスペック、コンテナイメージ、コンテナから他 AWS サービスへのアクセス権限
- サービス：クラスター内で必要なタスク数、タスクと ELB の連携

コンテナには、2 種類の環境がある

- AWS Fargate： コンテナ実行環境は負荷に応じて自動スケーリングされる。サーバーレスでコンテナ実行可能。タスクが実行されないときは料金が発生しない
- EC2 起動タイプ：ユーザーが管理している EC2 インスタンス上でコンテナ実行する。この場合は通常のインスタンス同様に OS・ミドルウェアのアップデートやスケーリングの管理が必要

## EKS(Elastic Kubernetes service)

ECS と同じで、コンテナの管理・実行ができる

kubernetes は、オープンソースのコンテナオーケストレーションプラットフォーム

実行中のアプリケーションの負荷状況に応じてリソース(ポッドやノード)を自動的にスケーリングできる機能がある

- Horizontal Pod Autoscaler：ポッドの数を自動的に増減
- Metrics Server：HPA を動作させるために、CPU 使用率やメモリ使用量の収集が必要で、そのために必要
- Cluster Autoscaler：クラスタ内のノード数を自動的に増減

## Amazon API Gateway

API のキャッシュを有効にできるので、同一リクエストに対する応答速度が向上する

作成できる API

- WebSocket
- REST

Lambda と組み合わせて、完全にサーバーレスでアプリケーションを実行可能

イメージ
client → API Gateway → Lambda function → DynamoDB

# ストレージ

## Amazon Storage Gateway

- ファイルゲートウェイ：SMB・NFS プロトコル　 S3、FSx のファイルストレージサービス
- ボリュームゲートウェイ：ISCSI プロトコル　キャッシュ型、保管型の S3 にローカルコピーまたは、スナップショットも保存する。オンプレミスに保存。
- テープゲートウェイ：物理テープストレージの代替として使用

## Amazon Snowball

オンプレミスの多量のデータを AWS ストレージへ転送するサービス

AWS Snow ファミリーは多量のデータを AWS ストレージへ転送するサービス。利用者には大容量のストレージを備えた機器が AWS から貸し出され、移行対象のデータを機器へ取り込んでから AWS へ返送すると、データが Amazon S3 へ保存される仕組みです。また、貸し出される機器には CPU（vCPU）やメモリなどを潤沢に搭載したものを選択でき、データ転送だけでなく、IoT 端末やエッジコンピューティング（IoT 端末自身、または近いエリアのサーバーで処理を行うこと）を実現することもできます。

## Snowcone

オフラインの転送および AWS DataSync を使用したオンラインでの転送にも対応

## Snowmobile

エクサバイト規模の転送サービス

## Amazon EFS

NFS をサポートするファイルストレージサービス

Amazon EFS では、ファイルシステムに対する読み取り・書き込み性能（パフォーマンス）をユーザーが調整可能

- 汎用パフォーマンスモード ... 一般的な用途向けのモード
- 最大 I/O パフォーマンスモード ... ビッグデータの解析などの大容量データや、数千台のクライアントの処理向けのモード

- 可用性：EFS はリージョン内の複数の AZ にまたがってサービスを提供しています。特定の AZ に障害が発生しても他の AZ でサービスが継続されるため、高い可用性を提供します。また、デフォルトで AWS Backup を使用したバックアップが有効になっています。
- 安全性：EFS はデフォルトで保管時のデータの暗号化が有効になっています。また、EFS ファイルシステムのマウント時に TLS（Transport Layer Security：セキュアな通信を行うプロトコル）の使用もできるので、安全にデータを転送できます。

#### デフォルトで有効な機能

- 自動バックアップ
- 保管されているデータの暗号化

#### スループットモード

- バーストスループットモード：ストレージの容量に従って、ベースライン性能が設定され、一時的に負荷が高くなった場合は 2 倍の性能向上ができる
- プロビジョンスループットモード：ユーザーが予約した（provisioned）性能を AWS が保証してスループットを提供する

NFS プロトコルは、ファイルに対するロック機構が使用されている。

ボリュームに保存したデータ量に伴って、自動的にスケーリングが行われる

## Amazon EBS

ブロックストレージサービス

EC2 のローカルストレージとして利用

ボリュームやスナップショットを暗号化することで機密性を高めることができます。暗号化する際は AWS KMS（Key Management Service：暗号化に使用するキーを作成・管理するサービス）を利用

Amazon EBS は、EC2 インスタンスの内部ストレージと同じように利用できるブロックストレージです。
Amazon EBS は設定によってはインスタンスを終了してもデータを永続的に保持することができます。単一 AZ 内で冗長化され、スナップショット機能や暗号化機能などを備えた、可用性・堅牢性に優れたストレージサービスです。

- 設定によっては EC2 インスタンスを終了してもデータが削除されない
- AWS によって冗長構成が組まれている
- スナップショットを作成できる

ボリュームタイプ

- 汎用 SSD：EC2 インスタンスのルートボリュームや、開発・テスト環境
- プロビジョン IOPS SSD：高い I/O 性能が必要なシステム
- プロビジョン IOPS SSD(block express)：最大 IOPS とスループット
- スループット最適化 HDD：シーケンシャルアクセスを行うデータやビックデータ、ログの処理
- Cold HDD：利用頻度が低いデータ保存

## Amazon FSx

Amazon FSx はファイル共有に適したファイルストレージサービス

### Amazon FSx For Windows

Amazon FSx For Windows ファイルサーバーは、Windows Server 上に構築されたファイルシステムを提供するストレージサービス

ファイルシステムには SMB プロトコルを使用して複数のクライアント（ファイルシステムを利用する端末）から共有してアクセスできます。
SMB プロトコルは主に Windows コンピュータ間においてファイル共有やプリンタ共有に使用されるプロトコルです。

Amazon EFS が Linux ベースの共有ファイルシステムであるのに対して、FSx For Windows ファイルサーバーは Windows ベースの共有ファイルシステムを提供します

提供している機能

- NTFS：標準ファイルシステム
- SMB：ファイル共有やプリンタ共有に使用されるプロトコル
- AD：ユーザーやコンピュータをドメイン単位で一括管理する機能
- Windows ACL：AD によって実現されるアクセス制御　リソースに対して、アクセス許可・拒否を設定可能
- DFS DFSR：複数のコンピュータに存在する共有フォルダなどを一括管理する機能

### Amazon FSx For Lustre

Amazon FSx For Lustre は、Lustre（ラスター）ファイルシステムを提供するストレージサービスです。Lustre は LinuxOS 用に設計されたオープンソースのファイルシステムで、主にスーパーコンピューターなどの HPC（High Performance Computing）や機械学習の分野で利用されています。大量のクライアントから低レイテンシかつ高スループットにファイルアクセスを行う必要のあるシステムで利用

##
